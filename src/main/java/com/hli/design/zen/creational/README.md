# 创建型模式（Creational Patterns）

> 📖 对应《设计模式之禅》第一篇：创建型模式

---

## 一、概述

创建型模式**关注对象的创建过程**，将对象的创建与使用分离，提高系统的灵活性和可扩展性。

> **核心思想**：封装对象的创建过程，让代码不依赖于具体类

---

## 二、5种创建型模式总览

| 模式 | 核心思想 | 解决的问题 | 面试频率 |
|------|----------|------------|----------|
| [单例模式](./singleton/README.md) | 确保只有一个实例 | 全局唯一、资源共享 | ★★★★★ |
| [工厂方法模式](./factory/README.md) | 延迟到子类决定创建 | 解耦创建与使用 | ★★★★★ |
| 抽象工厂模式 | 创建产品族 | 一系列相关产品 | ★★★★☆ |
| 建造者模式 | 分步构建复杂对象 | 复杂对象创建 | ★★★★☆ |
| 原型模式 | 克隆创建对象 | 对象复制 | ★★★☆☆ |

---

## 三、模式对比

### 3.1 选型决策树

```
需要创建对象？
     │
     ▼
全局只需一个？ ──是──▶ 单例模式
     │
     否
     │
     ▼
对象创建复杂？ ──是──▶ 建造者模式（多步构建）
     │
     否
     │
     ▼
需要复制对象？ ──是──▶ 原型模式
     │
     否
     │
     ▼
需要多个产品？ ──是──▶ 抽象工厂模式（产品族）
     │
     否
     ▼
工厂方法模式（单一产品）
```

### 3.2 核心区别

| 对比维度 | 单例 | 工厂 | 建造者 | 原型 |
|----------|------|------|--------|------|
| 关注点 | 实例数量 | 创建过程 | 构建步骤 | 复制方式 |
| 实例数 | 唯一 | 多个 | 多个 | 多个 |
| 创建方式 | 类内控制 | 工厂创建 | 分步构建 | 克隆 |

---

## 四、目录结构

```
creational/
├── README.md               # 本说明文档
├── singleton/              # ✅ 单例模式（已完成）
│   ├── README.md
│   ├── v1_bad/
│   ├── v2_dcl/
│   ├── v3_static_inner/
│   ├── v4_enum/
│   └── v5_spring/
├── factory/                # 🚧 工厂方法模式（进行中）
│   └── README.md
├── abstract_factory/       # 📋 抽象工厂模式（待实现）
├── builder/                # 📋 建造者模式（待实现）
└── prototype/              # 📋 原型模式（待实现）
```

---

## 五、面试高频问题

### Q1：创建型模式的共同特点是什么？

> 将对象的**创建**与**使用**分离，客户端不需要知道具体类的实现细节。

---

### Q2：什么情况下使用创建型模式？

| 场景 | 推荐模式 |
|------|----------|
| 全局配置、连接池、日志 | 单例模式 |
| 需要解耦具体类 | 工厂方法模式 |
| 创建跨平台UI组件 | 抽象工厂模式 |
| 构建复杂DTO/配置对象 | 建造者模式 |
| 快速复制对象 | 原型模式 |

---

### Q3：这些模式可以组合使用吗？

✅ **常见组合**：
- **单例 + 工厂**：工厂类本身是单例
- **建造者 + 抽象工厂**：工厂返回 Builder
- **原型 + 工厂**：工厂使用原型克隆创建

---

## 六、实际项目应用

| 模式 | JDK 示例 | Spring 示例 |
|------|----------|-------------|
| 单例 | `Runtime` | `ApplicationContext` |
| 工厂方法 | `Calendar.getInstance()` | `BeanFactory` |
| 抽象工厂 | `DocumentBuilderFactory` | `FactoryBean` |
| 建造者 | `StringBuilder` | `BeanDefinitionBuilder` |
| 原型 | `Object.clone()` | `@Scope("prototype")` |

---

## 七、学习路线建议

```
1. 单例模式（入门必会）
        ↓
2. 工厂方法模式（理解"封装创建"）
        ↓
3. 抽象工厂模式（理解"产品族"）
        ↓
4. 建造者模式（Lombok @Builder 原理）
        ↓
5. 原型模式（深拷贝 vs 浅拷贝）
```

---

## 八、代码实践指导

### 8.1 Spring 中的创建型模式

```java
// 单例模式：默认所有 Bean 都是单例
@Component
public class MyService { }

// 工厂方法：@Bean 方法
@Bean
public DataSource dataSource() {
    return createDataSource();
}

// 原型模式
@Scope("prototype")
@Component
public class PrototypeBean { }

// 建造者模式
MyConfig config = MyConfig.builder()
    .timeout(1000)
    .retries(3)
    .build();
```

---

> 📌 **学习建议**：按照单例 → 工厂 → 建造者 → 原型的顺序学习，先掌握面试高频模式。
